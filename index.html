<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minecraft Advancement Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #1a1a1a;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: #4CAF50;
            margin-bottom: 20px;
            text-align: center;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .player-select {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .player-select label {
            display: block;
            margin-bottom: 10px;
            font-size: 1.2em;
            color: #4CAF50;
        }

        select {
            width: 100%;
            padding: 12px;
            background-color: #3a3a3a;
            color: #e0e0e0;
            border: 2px solid #4CAF50;
            border-radius: 4px;
            font-size: 1em;
            cursor: pointer;
        }

        select:focus {
            outline: none;
            border-color: #66BB6A;
        }

        select:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .stats {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .stats span {
            font-size: 1.2em;
            color: #4CAF50;
            font-weight: bold;
        }

        .advancement-category {
            background-color: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
        }

        .category-header {
            font-size: 1.5em;
            color: #4CAF50;
            margin-bottom: 15px;
            border-bottom: 2px solid #4CAF50;
            padding-bottom: 10px;
        }

        .advancement-item {
            background-color: #3a3a3a;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid #4CAF50;
        }

        .advancement-item:hover {
            background-color: #454545;
            transform: translateX(5px);
        }

        .advancement-item.has-progress {
            border-left-color: #FFD700;
            background-color: #3a3a2a;
        }

        .advancement-item.has-progress:hover {
            background-color: #454535;
        }

        .advancement-item.hidden {
            display: none;
        }

        .advancement-name {
            font-size: 1.1em;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 8px;
        }

        .advancement-description {
            color: #b0b0b0;
            font-size: 0.95em;
            margin-bottom: 8px;
        }

        .advancement-progress {
            color: #4CAF50;
            font-size: 0.9em;
            font-style: italic;
            margin-bottom: 10px;
        }

        .missing-items {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #4a4a4a;
        }

        .missing-items-title {
            color: #FFD700;
            font-size: 0.9em;
            margin-bottom: 8px;
            font-weight: bold;
        }

        .missing-item {
            display: inline-block;
            background-color: #2a2a2a;
            padding: 5px 10px;
            margin: 3px;
            border-radius: 4px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid #555;
        }

        .missing-item:hover {
            background-color: #3a3a3a;
            border-color: #4CAF50;
        }

        .missing-item.clickable-criteria {
            background-color: #3a2a2a;
            border-color: #5a3a3a;
            cursor: pointer;
        }

        .missing-item.clickable-criteria:hover {
            background-color: #4a3a3a;
            border-color: #FF6B6B;
            transform: scale(1.05);
        }

        .missing-item.checked {
            background-color: #1a1a1a;
            color: #666;
            text-decoration: line-through;
            border-color: #333;
        }

        .no-advancements {
            text-align: center;
            padding: 40px;
            color: #888;
            font-size: 1.2em;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #4CAF50;
            font-size: 1.2em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚õèÔ∏è Minecraft Advancement Tracker</h1>
        
        <div class="player-select">
            <label for="playerSelect">Select Player:</label>
            <select id="playerSelect" disabled>
                <option value="">-- Loading players... --</option>
            </select>
            <p style="margin-top: 10px; color: #666; font-size: 0.85em;">
                üí° <strong>Tip:</strong> Click on missing criteria to mark them as done. Click advancement names to hide entire advancements.
            </p>
        </div>

        <div id="stats" class="stats" style="display: none;">
            <span id="statsText"></span>
        </div>

        <div id="advancementsList"></div>
    </div>

    <script>
        let playerData = null;
        let allAdvancements = {};
        let hiddenAdvancements = new Set();
        let checkedItems = {};
        let isDataLoaded = false;
        let currentPlayerName = '';

        // ============================================================
        // CONFIGURATION - UPDATE THESE FOR YOUR GITHUB PAGES SETUP
        // ============================================================
        
        // Base URL for your GitHub Pages site (include trailing slash)
        // Example: 'https://yourusername.github.io/minecraft-tracker/'
        // For local testing, use: '' (empty string)
        const BASE_URL = 'https://dmcclane1986.github.io/minecraft-tracker/';
        
        // List of player names (these should match filenames in player/ folder)
        // Example: If you have player/David.json, add 'David' to this list
        const PLAYERS = ['David', 'Lawrence'];
        
        // ============================================================

        // Embedded advancement definitions (from minecraft_advancements.json)
        const ADVANCEMENTS_DATA = {"minecraft_tab":[{"name":"Minecraft","description":"The heart and story of the game","requirement":"Have a crafting table in your inventory"},{"name":"Stone Age","description":"Mine stone with your new pickaxe","requirement":"Have any stone_tool_materials item in your inventory"},{"name":"Getting an Upgrade","description":"Construct a better pickaxe","requirement":"Have a stone pickaxe in your inventory"},{"name":"Acquire Hardware","description":"Smelt an iron ingot","requirement":"Have an iron ingot in your inventory"},{"name":"Suit Up","description":"Protect yourself with a piece of iron armor","requirement":"Have any piece of armor in your inventory"},{"name":"Hot Stuff","description":"Fill a bucket with lava","requirement":"Have a lava bucket in your inventory"},{"name":"Isn't It Iron Pick","description":"Upgrade your pickaxe","requirement":"Have an iron pickaxe in your inventory"},{"name":"Not Today, Thank You","description":"Deflect a projectile with a shield","requirement":"Successfully deflect a projectile with a shield"},{"name":"Ice Bucket Challenge","description":"Obtain a block of obsidian","requirement":"Have obsidian in your inventory"},{"name":"Diamonds!","description":"Acquire diamonds","requirement":"Have a diamond in your inventory"},{"name":"We Need to Go Deeper","description":"Build, light and enter a Nether Portal","requirement":"Enter the Nether dimension"},{"name":"Cover Me With Diamonds","description":"Diamond armor saves lives","requirement":"Have all pieces of diamond armor in your inventory"},{"name":"Enchanter","description":"Enchant an item at an Enchanting Table","requirement":"Use an enchanting table, then apply an enchantment"},{"name":"Zombie Doctor","description":"Weaken and then cure a Zombie Villager","requirement":"Feed a golden apple to a zombie villager under the Weakness effect until it converts into a villager"},{"name":"Eye Spy","description":"Follow an Eye of Ender","requirement":"Enter a stronghold"},{"name":"The End?","description":"Enter the End Portal","requirement":"Enter the End dimension"}],"nether_tab":[{"name":"Nether","description":"Bring summer clothes","requirement":"Enter the Nether dimension"},{"name":"Return to Sender","description":"Destroy a Ghast with a fireball","requirement":"Kill a Ghast with its own fireball","type":"goal","experience":50},{"name":"Those Were the Days","description":"Enter a Bastion Remnant","requirement":"Enter a bastion remnant"},{"name":"Hidden in the Depths","description":"Obtain Ancient Debris","requirement":"Have ancient debris in your inventory"},{"name":"Subspace Bubble","description":"Use the Nether to travel 7 km in the Overworld","requirement":"Travel between 2 points in the Overworld with 7000 blocks horizontal distance via the Nether (875 blocks in Nether)","type":"challenge","experience":100},{"name":"A Terrible Fortress","description":"Break your way into a Nether Fortress","requirement":"Enter a Nether Fortress"},{"name":"Who is Cutting Onions?","description":"Obtain Crying Obsidian","requirement":"Have Crying Obsidian in your inventory"},{"name":"Oh Shiny","description":"Distract Piglins with gold","requirement":"Give a piglin one of 25 gold-related items from the piglin_loved item tag"},{"name":"This Boat Has Legs","description":"Ride a Strider with a Warped Fungus on a Stick","requirement":"Boost a strider with a warped fungus on a stick"},{"name":"Uneasy Alliance","description":"Rescue a Ghast from the Nether, bring it safely home to the Overworld... and then kill it","requirement":"Kill a ghast while in the Overworld","type":"challenge","experience":100},{"name":"War Pigs","description":"Loot a chest in a Bastion Remnant","requirement":"Open a chest in a bastion remnant"},{"name":"Country Lode, Take Me Home","description":"Use a Compass on a Lodestone","requirement":"Use a Compass on a Lodestone"},{"name":"Cover Me in Debris","description":"Get a full suit of Netherite armor","requirement":"Have all pieces of netherite armor in your inventory","type":"challenge","experience":100},{"name":"Spooky Scary Skeleton","description":"Obtain a Wither Skeleton's skull","requirement":"Have a wither skeleton skull in your inventory"},{"name":"Into Fire","description":"Relieve a Blaze of its rod","requirement":"Have a blaze rod in your inventory"},{"name":"Not Quite \"Nine\" Lives","description":"Charge a Respawn Anchor to the maximum","requirement":"Fully charge a Respawn Anchor"},{"name":"Feels Like Home","description":"Take a Strider for a loooong ride on a lava lake in the Overworld","requirement":"Ride a strider on lava in the Overworld for 50 blocks horizontally"},{"name":"Hot Tourist Destinations","description":"Explore all Nether biomes","requirement":"Visit all 5 Nether biomes","type":"challenge","experience":500},{"name":"Withering Heights","description":"Summon the Wither","requirement":"Summon a Wither"},{"name":"Local Brewery","description":"Brew a Potion","requirement":"Pick up an item from a brewing stand potion slot"},{"name":"Bring Home the Beacon","description":"Construct and place a Beacon","requirement":"Be near a beacon block when it realizes it has become powered"},{"name":"A Furious Cocktail","description":"Have every potion effect applied at the same time","requirement":"Have all 13 specified potion effects applied simultaneously","type":"challenge","experience":1000},{"name":"Beaconator","description":"Bring a beacon to full power","requirement":"Be near a beacon powered by a size 4 pyramid","type":"goal","experience":50},{"name":"How Did We Get Here?","description":"Have every effect applied at the same time","requirement":"Have all 33 status effects applied at the same time","type":"challenge","experience":1000,"hidden":true}],"the_end_tab":[{"name":"The End?","description":"Or the beginning?","requirement":"Enter the End dimension"},{"name":"Free the End","description":"Good luck","requirement":"Kill the ender dragon"},{"name":"The Next Generation","description":"Hold the Dragon Egg","requirement":"Have a dragon egg in your inventory","type":"goal","experience":50},{"name":"Remote Getaway","description":"Escape the island","requirement":"Throw an ender pearl through, fly, or walk into an end gateway"},{"name":"The End... Again...","description":"Respawn the Ender Dragon","requirement":"Summon the ender dragon using end crystals","type":"goal","experience":50},{"name":"You Need a Mint","description":"Collect Dragon's Breath in a Glass Bottle","requirement":"Have Dragon's Breath in your inventory","type":"goal","experience":50},{"name":"The City at the End of the Game","description":"Go on in, what could happen?","requirement":"Enter an end city"},{"name":"Sky's the Limit","description":"Find elytra","requirement":"Have elytra in your inventory","type":"goal","experience":50},{"name":"Great View From Up Here","description":"Levitate up 50 blocks from the attacks of a Shulker","requirement":"Rise 50 blocks vertically with the Levitation effect","type":"challenge","experience":50}],"adventure_tab":[{"name":"Adventure","description":"Adventure, exploration, and combat","requirement":"Kill any entity, or be killed by any entity"},{"name":"Voluntary Exile","description":"Kill a raid captain. Maybe consider staying away from villages for the time being...","requirement":"Kill any entity from the raiders tag wearing an ominous banner","hidden":true},{"name":"Is It a Bird?","description":"Look at a Parrot through a Spyglass","requirement":"View a Parrot through a Spyglass"},{"name":"Monster Hunter","description":"Kill any hostile monster","requirement":"Kill one of 36 specified hostile mobs"},{"name":"The Power of Books","description":"Read the power signal of a Chiseled Bookshelf using a Comparator","requirement":"Read a chiseled bookshelf with a comparator"},{"name":"What a Deal!","description":"Successfully trade with a Villager","requirement":"Take an item from a villager or wandering trader's trading output slot"},{"name":"Smithing with Style","description":"Apply these smithing templates at least once: Spire, Snout, Rib, Ward, Silence, Vex, Tide, Wayfinder","requirement":"Apply all exclusive armor trim patterns","type":"challenge","experience":150},{"name":"Sticky Situation","description":"Jump into a Honey Block to break your fall","requirement":"Collide with a Honey Block to break a fall"},{"name":"Ol' Betsy","description":"Shoot a Crossbow","requirement":"Shoot a Crossbow"},{"name":"Surge Protector","description":"Protect a Villager from an undesired shock without starting a fire","requirement":"Protect a villager from lightning with a lightning rod"},{"name":"Caves & Cliffs","description":"Free fall from the top of the world (build limit) to the bottom of the world and survive","requirement":"Fall from Y=320 to Y=-59 and survive"},{"name":"Respecting the Remnants","description":"Brush a Suspicious block to obtain a Pottery Sherd","requirement":"Brush a suspicious block to get a pottery sherd"},{"name":"Sneak 100","description":"Sneaking next to a Sculk Sensor or Warden to prevent it from detecting you","requirement":"Avoid vibrations while near a sculk sensor or warden"},{"name":"Sweet Dreams","description":"Sleep in a Bed","requirement":"Enter a bed"},{"name":"Hero of the Village","description":"Successfully defend a village from a raid","requirement":"Successfully defend a raid","type":"challenge","experience":100,"hidden":true},{"name":"Is It a Balloon?","description":"Look at a Ghast through a Spyglass","requirement":"View a Ghast through a Spyglass"},{"name":"A Throwaway Joke","description":"Throw a trident at something. Note: Throwing away your only weapon is not a good idea.","requirement":"Kill a mob with a thrown trident"},{"name":"It Spreads","description":"Kill a mob near a Sculk Catalyst","requirement":"Kill any of 81 specified mobs near a Sculk Catalyst","type":"challenge","experience":50},{"name":"Take Aim","description":"Shoot something with an arrow","requirement":"Shoot an entity with an arrow or tipped/spectral arrow"},{"name":"Monsters Hunted","description":"Kill one of every hostile monster","requirement":"Kill all 38 specified hostile mobs","type":"challenge","experience":100},{"name":"Postmortal","description":"Use a Totem of Undying to cheat death","requirement":"Use a Totem of Undying","type":"goal","experience":50},{"name":"Hired Help","description":"Summon an Iron Golem to help defend a village","requirement":"Summon an Iron Golem","type":"goal","experience":50},{"name":"Star Trader","description":"Trade with a Villager at the build height limit","requirement":"Trade with a villager at Y=320 or above"},{"name":"Two Birds, One Arrow","description":"Kill two Phantoms with a piercing arrow","requirement":"Kill two phantoms with one arrow using a crossbow with Piercing","type":"challenge","experience":65},{"name":"Who's the Pillager Now?","description":"Give a Pillager a taste of their own medicine","requirement":"Kill a pillager with a crossbow"},{"name":"Arbalistic","description":"Kill five unique mobs with one crossbow shot","requirement":"Kill five different mobs with a single crossbow shot","type":"challenge","experience":85,"hidden":true},{"name":"Careful Restoration","description":"Make a Decorated Pot out of 4 Pottery Sherds","requirement":"Craft a decorated pot using only pottery sherds"},{"name":"Adventuring Time","description":"Discover every biome","requirement":"Visit all 61 Overworld biomes","type":"challenge","experience":500},{"name":"Sound of Music","description":"Make the Meadows come alive with the sound of music from a jukebox","requirement":"Play a music disc in a jukebox in a meadows biome"},{"name":"Light as a Rabbit","description":"Walk on Powder Snow... without sinking in it","requirement":"Walk on powder snow with leather boots"},{"name":"Is It a Plane?","description":"Look at the Ender Dragon through a Spyglass","requirement":"View an Ender Dragon through a Spyglass"},{"name":"Very Very Frightening","description":"Strike a Villager with lightning","requirement":"Hit a villager with lightning using a trident with Channeling"},{"name":"Sniper Duel","description":"Kill a Skeleton from at least 50 meters away","requirement":"Kill a skeleton with an arrow from 50+ meters away","type":"challenge","experience":50},{"name":"Bullseye","description":"Hit the bullseye of a Target block from at least 30 meters away","requirement":"Hit a target block from 30+ meters away","type":"challenge","experience":50},{"name":"Minecraft: Trial(s) Edition","description":"Step foot in a Trial Chamber","requirement":"Enter a trial chamber"},{"name":"Under Lock and Key","description":"Unlock a Vault using a Trial Key","requirement":"Use a trial key on a vault"},{"name":"Blowback","description":"Kill a Breeze with a deflected Wind Charge","requirement":"Kill a breeze by deflecting its wind charge back at it","type":"challenge","experience":40},{"name":"Who Needs Rockets?","description":"Use a Wind Charge to launch yourself upward at least 8 blocks","requirement":"Launch yourself 8+ blocks upward with a wind charge","type":"goal","experience":30},{"name":"Lighten Up","description":"Scrape a Copper Bulb with an Axe to make it brighter","requirement":"Scrape oxidation off a copper bulb with an axe"},{"name":"Revaulting","description":"Unlock an Ominous Vault with an Ominous Trial Key","requirement":"Use an ominous trial key on an ominous vault"},{"name":"Crafters Crafting Crafters","description":"Be near a Crafter when it crafts a Crafter","requirement":"Be within 5 blocks of a crafter when it crafts another crafter"},{"name":"Over-Overkill","description":"Deal 50 hearts of damage in a single hit using a Mace","requirement":"Deal 100+ points of damage in a single mace attack","type":"challenge","experience":50},{"name":"Overkill","description":"Deal 9 hearts of damage in a single hit","requirement":"Deal 18 or more points of damage in a single hit","type":"challenge","experience":30}],"husbandry_tab":[{"name":"Husbandry","description":"The world is full of friends and food","requirement":"Consume anything that can be eaten"},{"name":"Bee Our Guest","description":"Use a Campfire to collect Honey from a Beehive using a Glass Bottle without aggravating the Bees","requirement":"Use a glass bottle on a beehive/bee nest while not angering bees"},{"name":"The Parrots and the Bats","description":"Breed two animals together","requirement":"Breed any two breedable mobs"},{"name":"You've Got a Friend in Me","description":"Have an Allay deliver items to you","requirement":"Have an allay deliver an item to you","hidden":true},{"name":"Whatever Floats Your Goat!","description":"Get in a Boat and float with a Goat","requirement":"Ride in a boat with a goat"},{"name":"Best Friends Forever","description":"Tame an animal","requirement":"Tame one of: cat, donkey, horse, llama, parrot, or wolf"},{"name":"Glow and Behold!","description":"Make the text of any kind of sign glow","requirement":"Use a glow ink sac on a sign or hanging sign"},{"name":"Fishy Business","description":"Catch a fish","requirement":"Catch cod, salmon, pufferfish, or tropical fish with a fishing rod"},{"name":"Total Beelocation","description":"Move and place a Bee Nest, with 3 Bees inside, using Silk Touch","requirement":"Move a bee nest with 3 bees using Silk Touch"},{"name":"Bukkit Bukkit","description":"Catch a Tadpole in a Bucket","requirement":"Use a water bucket on a tadpole"},{"name":"Smells Interesting","description":"Obtain a Sniffer Egg","requirement":"Have a sniffer egg in your inventory","hidden":true},{"name":"A Seedy Place","description":"Plant any Sniffer seed","requirement":"Plant a seed"},{"name":"Wax On","description":"Apply Honeycomb to a Copper block!","requirement":"Wax a copper block with honeycomb"},{"name":"Two by Two","description":"Breed all the animals!","requirement":"Breed all 26 breedable mobs","type":"challenge","experience":100},{"name":"Birthday Song","description":"Have an Allay drop a Cake at a Note Block","requirement":"Have an allay drop a cake at a note block","hidden":true},{"name":"A Complete Catalogue","description":"Tame all Cat variants!","requirement":"Tame all 11 cat variants","type":"challenge","experience":50},{"name":"The Whole Pack","description":"Tame all Dog variants!","requirement":"Tame all 9 wolf variants","type":"challenge","experience":50},{"name":"Tactical Fishing","description":"Catch a fish... without a fishing rod!","requirement":"Use a water bucket on any fish mob"},{"name":"When the Squad Hops into Town","description":"Get each Frog variant on a Lead","requirement":"Leash all 3 frog variants"},{"name":"Little Sniffs","description":"Feed a Snifflet","requirement":"Feed a snifflet","hidden":true},{"name":"A Balanced Diet","description":"Eat everything that is edible, even if it's not good for you","requirement":"Eat all 41 specified foods","type":"challenge","experience":100},{"name":"Serious Dedication","description":"Use a Netherite Ingot to upgrade a Hoe, and then reevaluate your life choices","requirement":"Have a netherite hoe in your inventory","type":"challenge","experience":100},{"name":"Wax Off","description":"Scrape Wax off of a Copper block!","requirement":"Use an axe to scrape wax from a copper block"},{"name":"The Cutest Predator","description":"Catch an Axolotl in a Bucket","requirement":"Use a water bucket on an axolotl"},{"name":"With Our Powers Combined!","description":"Have all Froglights in your inventory","requirement":"Have all 3 froglights in inventory","type":"challenge","experience":50},{"name":"Planting the Past","description":"Plant any Sniffer seed","requirement":"Plant a torchflower seed or pitcher pod","hidden":true},{"name":"The Healing Power of Friendship!","description":"Team up with an axolotl and win a fight","requirement":"Get a Regeneration effect from helping an axolotl kill a mob"},{"name":"Good as New","description":"Repair a damaged Wolf Armor using Armadillo Scutes","requirement":"Repair wolf armor with armadillo scutes"},{"name":"Shear Brilliance","description":"Remove Wolf Armor from a Wolf using Shears","requirement":"Use shears to remove wolf armor from a tamed wolf"},{"name":"Isn't It Scute?","description":"Get Armadillo Scutes from an Armadillo using a Brush","requirement":"Use a brush on an armadillo to get scutes"}]};

        // Initialize on page load
        function init() {
            allAdvancements = processAdvancementsData(ADVANCEMENTS_DATA);
            isDataLoaded = true;
            
            // Populate player dropdown
            const playerSelect = document.getElementById('playerSelect');
            playerSelect.innerHTML = '<option value="">-- Select a Player --</option>';
            
            PLAYERS.forEach(name => {
                const option = document.createElement('option');
                option.value = name;
                option.textContent = name;
                playerSelect.appendChild(option);
            });
            
            playerSelect.disabled = false;
            displayAdvancements();
        }

        // Handle player selection from dropdown
        document.getElementById('playerSelect').addEventListener('change', async function() {
            const playerName = this.value;
            
            if (!playerName) {
                playerData = null;
                currentPlayerName = '';
                displayAdvancements();
                return;
            }

            // Show loading state
            document.getElementById('advancementsList').innerHTML = 
                '<div class="loading">Loading player data...</div>';

            try {
                const response = await fetch(`${BASE_URL}player/${playerName}.json`);
                
                if (!response.ok) {
                    throw new Error(`Player file not found (${response.status})`);
                }
                
                playerData = await response.json();
                currentPlayerName = playerName;
                hiddenCriteriaItems = {};
                hiddenAdvancements.clear();
                displayAdvancements();
            } catch (error) {
                console.error('Error loading player data:', error);
                playerData = null;
                document.getElementById('advancementsList').innerHTML = 
                    `<div class="no-advancements">‚ùå Could not load data for ${playerName}<br><small style="color:#666;">${error.message}</small></div>`;
            }
        });

        // Mapping of advancement names to their actual Minecraft keys
        // For advancements with duplicate names across tabs, use "tab:name" format
        const ADVANCEMENT_KEY_MAP = {
            // Minecraft tab (story)
            'Minecraft': 'minecraft:story/root',
            'minecraft_tab:The End?': 'minecraft:story/enter_the_end',
            'the_end_tab:The End?': 'minecraft:end/root',
            'Stone Age': 'minecraft:story/mine_stone',
            'Getting an Upgrade': 'minecraft:story/upgrade_tools',
            'Acquire Hardware': 'minecraft:story/smelt_iron',
            'Suit Up': 'minecraft:story/obtain_armor',
            'Hot Stuff': 'minecraft:story/lava_bucket',
            "Isn't It Iron Pick": 'minecraft:story/iron_tools',
            'Not Today, Thank You': 'minecraft:story/deflect_arrow',
            'Ice Bucket Challenge': 'minecraft:story/form_obsidian',
            'Diamonds!': 'minecraft:story/mine_diamond',
            'We Need to Go Deeper': 'minecraft:story/enter_the_nether',
            'Cover Me With Diamonds': 'minecraft:story/shiny_gear',
            'Enchanter': 'minecraft:story/enchant_item',
            'Zombie Doctor': 'minecraft:story/cure_zombie_villager',
            'Eye Spy': 'minecraft:story/follow_ender_eye',
            
            // Nether tab
            'Nether': 'minecraft:nether/root',
            'Return to Sender': 'minecraft:nether/return_to_sender',
            'Those Were the Days': 'minecraft:nether/find_bastion',
            'Hidden in the Depths': 'minecraft:nether/obtain_ancient_debris',
            'Subspace Bubble': 'minecraft:nether/fast_travel',
            'A Terrible Fortress': 'minecraft:nether/find_fortress',
            'Who is Cutting Onions?': 'minecraft:nether/obtain_crying_obsidian',
            'Oh Shiny': 'minecraft:nether/distract_piglin',
            'This Boat Has Legs': 'minecraft:nether/ride_strider',
            'Uneasy Alliance': 'minecraft:nether/uneasy_alliance',
            'War Pigs': 'minecraft:nether/loot_bastion',
            'Country Lode, Take Me Home': 'minecraft:nether/use_lodestone',
            'Cover Me in Debris': 'minecraft:nether/netherite_armor',
            'Spooky Scary Skeleton': 'minecraft:nether/get_wither_skull',
            'Into Fire': 'minecraft:nether/obtain_blaze_rod',
            'Not Quite "Nine" Lives': 'minecraft:nether/charge_respawn_anchor',
            'Feels Like Home': 'minecraft:nether/ride_strider_in_overworld_lava',
            'Hot Tourist Destinations': 'minecraft:nether/explore_nether',
            'Withering Heights': 'minecraft:nether/summon_wither',
            'Local Brewery': 'minecraft:nether/brew_potion',
            'Bring Home the Beacon': 'minecraft:nether/create_beacon',
            'A Furious Cocktail': 'minecraft:nether/all_potions',
            'Beaconator': 'minecraft:nether/create_full_beacon',
            'How Did We Get Here?': 'minecraft:nether/all_effects',
            
            // The End tab
            'Free the End': 'minecraft:end/kill_dragon',
            'The Next Generation': 'minecraft:end/dragon_egg',
            'Remote Getaway': 'minecraft:end/enter_end_gateway',
            'The End... Again...': 'minecraft:end/respawn_dragon',
            'You Need a Mint': 'minecraft:end/dragon_breath',
            'The City at the End of the Game': 'minecraft:end/find_end_city',
            "Sky's the Limit": 'minecraft:end/elytra',
            'Great View From Up Here': 'minecraft:end/levitate',
            
            // Adventure tab
            'Adventure': 'minecraft:adventure/root',
            'Voluntary Exile': 'minecraft:adventure/voluntary_exile',
            'Is It a Bird?': 'minecraft:adventure/spyglass_at_parrot',
            'Monster Hunter': 'minecraft:adventure/kill_a_mob',
            'The Power of Books': 'minecraft:adventure/read_power_of_chiseled_bookshelf',
            'What a Deal!': 'minecraft:adventure/trade',
            'Smithing with Style': 'minecraft:adventure/trim_with_all_exclusive_armor_patterns',
            'Sticky Situation': 'minecraft:adventure/honey_block_slide',
            "Ol' Betsy": 'minecraft:adventure/ol_betsy',
            'Surge Protector': 'minecraft:adventure/lightning_rod_with_villager_no_fire',
            'Caves & Cliffs': 'minecraft:adventure/fall_from_world_height',
            'Respecting the Remnants': 'minecraft:adventure/salvage_sherd',
            'Sneak 100': 'minecraft:adventure/avoid_vibration',
            'Sweet Dreams': 'minecraft:adventure/sleep_in_bed',
            'Hero of the Village': 'minecraft:adventure/hero_of_the_village',
            'Is It a Balloon?': 'minecraft:adventure/spyglass_at_ghast',
            'A Throwaway Joke': 'minecraft:adventure/throw_trident',
            'It Spreads': 'minecraft:adventure/kill_mob_near_sculk_catalyst',
            'Take Aim': 'minecraft:adventure/shoot_arrow',
            'Monsters Hunted': 'minecraft:adventure/kill_all_mobs',
            'Postmortal': 'minecraft:adventure/totem_of_undying',
            'Hired Help': 'minecraft:adventure/summon_iron_golem',
            'Star Trader': 'minecraft:adventure/trade_at_world_height',
            'Two Birds, One Arrow': 'minecraft:adventure/two_birds_one_arrow',
            "Who's the Pillager Now?": 'minecraft:adventure/whos_the_pillager_now',
            'Arbalistic': 'minecraft:adventure/arbalistic',
            'Careful Restoration': 'minecraft:adventure/craft_decorated_pot_using_only_sherds',
            'Adventuring Time': 'minecraft:adventure/adventuring_time',
            'Sound of Music': 'minecraft:adventure/play_jukebox_in_meadows',
            'Light as a Rabbit': 'minecraft:adventure/walk_on_powder_snow_with_leather_boots',
            'Is It a Plane?': 'minecraft:adventure/spyglass_at_dragon',
            'Very Very Frightening': 'minecraft:adventure/very_very_frightening',
            'Sniper Duel': 'minecraft:adventure/sniper_duel',
            'Bullseye': 'minecraft:adventure/bullseye',
            'Minecraft: Trial(s) Edition': 'minecraft:adventure/minecraft_trials_edition',
            'Under Lock and Key': 'minecraft:adventure/under_lock_and_key',
            'Blowback': 'minecraft:adventure/blowback',
            'Who Needs Rockets?': 'minecraft:adventure/who_needs_rockets',
            'Lighten Up': 'minecraft:adventure/lighten_up',
            'Revaulting': 'minecraft:adventure/revaulting',
            'Crafters Crafting Crafters': 'minecraft:adventure/crafters_crafting_crafters',
            'Over-Overkill': 'minecraft:adventure/over_overkill',
            'Overkill': 'minecraft:adventure/overkill',
            
            // Husbandry tab
            'Husbandry': 'minecraft:husbandry/root',
            'Bee Our Guest': 'minecraft:husbandry/safely_harvest_honey',
            'The Parrots and the Bats': 'minecraft:husbandry/breed_an_animal',
            "You've Got a Friend in Me": 'minecraft:husbandry/allay_deliver_item_to_player',
            'Whatever Floats Your Goat!': 'minecraft:husbandry/ride_a_boat_with_a_goat',
            'Best Friends Forever': 'minecraft:husbandry/tame_an_animal',
            'Glow and Behold!': 'minecraft:husbandry/make_a_sign_glow',
            'Fishy Business': 'minecraft:husbandry/fishy_business',
            'Total Beelocation': 'minecraft:husbandry/silk_touch_nest',
            'Bukkit Bukkit': 'minecraft:husbandry/tadpole_in_a_bucket',
            'Smells Interesting': 'minecraft:husbandry/obtain_sniffer_egg',
            'A Seedy Place': 'minecraft:husbandry/plant_seed',
            'Wax On': 'minecraft:husbandry/wax_on',
            'Two by Two': 'minecraft:husbandry/bred_all_animals',
            'Birthday Song': 'minecraft:husbandry/allay_deliver_cake_to_note_block',
            'A Complete Catalogue': 'minecraft:husbandry/complete_catalogue',
            'The Whole Pack': 'minecraft:husbandry/whole_pack',
            'Tactical Fishing': 'minecraft:husbandry/tactical_fishing',
            'When the Squad Hops into Town': 'minecraft:husbandry/leash_all_frog_variants',
            'Little Sniffs': 'minecraft:husbandry/feed_snifflet',
            'A Balanced Diet': 'minecraft:husbandry/balanced_diet',
            'Serious Dedication': 'minecraft:husbandry/obtain_netherite_hoe',
            'Wax Off': 'minecraft:husbandry/wax_off',
            'The Cutest Predator': 'minecraft:husbandry/axolotl_in_a_bucket',
            'With Our Powers Combined!': 'minecraft:husbandry/froglights',
            'Planting the Past': 'minecraft:husbandry/plant_any_sniffer_seed',
            'The Healing Power of Friendship!': 'minecraft:husbandry/kill_axolotl_target',
            'Good as New': 'minecraft:husbandry/repair_wolf_armor',
            'Shear Brilliance': 'minecraft:husbandry/remove_wolf_armor',
            "Isn't It Scute?": 'minecraft:husbandry/obtain_armadillo_scutes'
        };

        // Full criteria lists for multi-criteria advancements
        const ADVANCEMENT_CRITERIA = {
            'minecraft:adventure/adventuring_time': [
                'badlands', 'bamboo_jungle', 'beach', 'birch_forest', 'cherry_grove', 'cold_ocean',
                'dark_forest', 'deep_cold_ocean', 'deep_dark', 'deep_frozen_ocean', 'deep_lukewarm_ocean',
                'deep_ocean', 'desert', 'dripstone_caves', 'eroded_badlands', 'flower_forest',
                'forest', 'frozen_ocean', 'frozen_peaks', 'frozen_river', 'grove', 'ice_spikes',
                'jagged_peaks', 'jungle', 'lukewarm_ocean', 'lush_caves', 'mangrove_swamp',
                'meadow', 'mushroom_fields', 'ocean', 'old_growth_birch_forest', 'old_growth_pine_taiga',
                'old_growth_spruce_taiga', 'plains', 'river', 'savanna', 'savanna_plateau',
                'snowy_beach', 'snowy_plains', 'snowy_slopes', 'snowy_taiga', 'sparse_jungle',
                'stony_peaks', 'stony_shore', 'sunflower_plains', 'swamp', 'taiga',
                'warm_ocean', 'windswept_forest', 'windswept_gravelly_hills', 'windswept_hills',
                'windswept_savanna', 'wooded_badlands'
            ],
            'minecraft:adventure/kill_all_mobs': [
                'blaze', 'bogged', 'breeze', 'cave_spider', 'creeper', 'drowned', 'elder_guardian',
                'ender_dragon', 'enderman', 'endermite', 'evoker', 'ghast', 'guardian', 'hoglin',
                'husk', 'magma_cube', 'phantom', 'piglin', 'piglin_brute', 'pillager', 'ravager',
                'shulker', 'silverfish', 'skeleton', 'slime', 'spider', 'stray', 'vex', 'vindicator',
                'warden', 'witch', 'wither', 'wither_skeleton', 'zoglin', 'zombie', 'zombie_villager',
                'zombified_piglin'
            ],
            'minecraft:nether/explore_nether': [
                'basalt_deltas', 'crimson_forest', 'nether_wastes', 'soul_sand_valley', 'warped_forest'
            ],
            'minecraft:nether/all_potions': [
                'fire_resistance', 'invisibility', 'jump_boost', 'night_vision', 'poison',
                'regeneration', 'slow_falling', 'slowness', 'speed', 'strength',
                'turtle_master', 'water_breathing', 'weakness'
            ],
            'minecraft:nether/all_effects': [
                'absorption', 'bad_omen', 'blindness', 'conduit_power', 'darkness',
                'dolphins_grace', 'fatal_poison', 'fire_resistance', 'glowing', 'haste',
                'health_boost', 'hero_of_the_village', 'hunger', 'infested', 'instant_damage',
                'instant_health', 'invisibility', 'jump_boost', 'levitation', 'luck',
                'mining_fatigue', 'nausea', 'night_vision', 'oozing', 'poison', 'raid_omen',
                'regeneration', 'resistance', 'saturation', 'slow_falling', 'slowness',
                'speed', 'strength', 'trial_omen', 'unluck', 'water_breathing',
                'weakness', 'weaving', 'wind_charged', 'wither'
            ],
            'minecraft:husbandry/bred_all_animals': [
                'armadillo', 'axolotl', 'bee', 'camel', 'cat', 'chicken', 'cow', 'donkey',
                'fox', 'frog', 'goat', 'hoglin', 'horse', 'llama', 'mooshroom', 'mule',
                'ocelot', 'panda', 'pig', 'rabbit', 'sheep', 'sniffer', 'strider',
                'trader_llama', 'turtle', 'wolf'
            ],
            'minecraft:husbandry/balanced_diet': [
                'apple', 'baked_potato', 'beef', 'beetroot', 'beetroot_soup', 'bread',
                'carrot', 'chicken', 'chorus_fruit', 'cod', 'cooked_beef', 'cooked_chicken',
                'cooked_cod', 'cooked_mutton', 'cooked_porkchop', 'cooked_rabbit',
                'cooked_salmon', 'cookie', 'dried_kelp', 'enchanted_golden_apple',
                'glow_berries', 'golden_apple', 'golden_carrot', 'honey_bottle',
                'melon_slice', 'mushroom_stew', 'mutton', 'poisonous_potato', 'porkchop',
                'potato', 'pufferfish', 'pumpkin_pie', 'rabbit', 'rabbit_stew', 'rotten_flesh',
                'salmon', 'spider_eye', 'suspicious_stew', 'sweet_berries', 'tropical_fish'
            ],
            'minecraft:husbandry/complete_catalogue': [
                'all_black', 'black', 'british_shorthair', 'calico', 'jellie',
                'persian', 'ragdoll', 'red', 'siamese', 'tabby', 'white'
            ],
            'minecraft:husbandry/whole_pack': [
                'ashen', 'black', 'chestnut', 'pale', 'rusty',
                'snowy', 'spotted', 'striped', 'woods'
            ],
            'minecraft:husbandry/leash_all_frog_variants': [
                'cold', 'temperate', 'warm'
            ],
            'minecraft:husbandry/froglights': [
                'ochre', 'pearlescent', 'verdant'
            ]
        };

        // Track manually hidden criteria items (persists during session)
        let hiddenCriteriaItems = {};

        // Create reverse mapping (key -> advancement info)
        let advancementsByKey = {};

        function processAdvancementsData(data) {
            const advancements = {};
            advancementsByKey = {};
            
            // Process each tab
            for (const [tabName, tabAdvancements] of Object.entries(data)) {
                tabAdvancements.forEach(advancement => {
                    // Look up the actual key from the mapping
                    // Check for tab-specific key first (for handling duplicate names)
                    const tabSpecificKey = `${tabName}:${advancement.name}`;
                    const key = ADVANCEMENT_KEY_MAP[tabSpecificKey] || ADVANCEMENT_KEY_MAP[advancement.name];
                    
                    const advInfo = {
                        name: advancement.name,
                        description: advancement.description,
                        requirement: advancement.requirement,
                        tab: tabName.replace('_tab', ''),
                        type: advancement.type || 'task',
                        hidden: advancement.hidden || false
                    };
                    
                    if (key) {
                        advancements[key] = advInfo;
                        advancementsByKey[key] = advInfo;
                    }
                    
                    // Also store by name for fallback
                    advancements[advancement.name] = advInfo;
                });
            }
            
            return advancements;
        }


        function displayAdvancements() {
            const listContainer = document.getElementById('advancementsList');
            const statsContainer = document.getElementById('stats');
            const statsText = document.getElementById('statsText');
            
            if (!isDataLoaded) {
                listContainer.innerHTML = '<div class="loading">Loading advancement data...</div>';
                statsContainer.style.display = 'none';
                return;
            }
            
            if (!playerData) {
                listContainer.innerHTML = '<div class="loading">Please select a player</div>';
                statsContainer.style.display = 'none';
                return;
            }

            // Find all incomplete advancements by checking all known advancements
            const incompleteAdvancements = [];
            const completedCount = { total: 0 };
            
            // Check each advancement from our definitions
            for (const [key, advInfo] of Object.entries(advancementsByKey)) {
                // Skip if hidden by user
                if (hiddenAdvancements.has(key)) continue;
                
                // Check player data for this advancement
                const playerAdvancement = playerData[key];
                const isDone = playerAdvancement?.done === true;
                
                if (isDone) {
                    completedCount.total++;
                    continue;
                }
                
                // Get completed criteria if any
                const completedCriteria = Object.keys(playerAdvancement?.criteria || {})
                    .map(c => c.replace('minecraft:', ''));
                const completedCount2 = completedCriteria.length;
                
                // Calculate missing criteria if we have the full list
                const allCriteria = ADVANCEMENT_CRITERIA[key] || [];
                const hiddenForThis = hiddenCriteriaItems[key] || new Set();
                
                // Missing = all required - completed - manually hidden
                const missingCriteria = allCriteria.filter(c => 
                    !completedCriteria.includes(c) && !hiddenForThis.has(c)
                );
                
                incompleteAdvancements.push({
                    key,
                    name: advInfo.name,
                    description: advInfo.description,
                    requirement: advInfo.requirement,
                    tab: advInfo.tab,
                    completedCriteria: completedCriteria,
                    completedCount: completedCount2,
                    missingCriteria: missingCriteria,
                    totalCriteria: allCriteria.length,
                    type: advInfo.type || 'task',
                    hasProgress: completedCount2 > 0
                });
            }

            // Calculate total advancements
            const totalAdvancements = Object.keys(advancementsByKey).length;

            if (incompleteAdvancements.length === 0) {
                listContainer.innerHTML = '<div class="no-advancements">üéâ All advancements completed!</div>';
                statsContainer.style.display = 'none';
                return;
            }

            // Group by tab
            const grouped = {};
            incompleteAdvancements.forEach(adv => {
                if (!grouped[adv.tab]) {
                    grouped[adv.tab] = [];
                }
                grouped[adv.tab].push(adv);
            });

            // Sort within each group: in-progress first, then by type
            Object.values(grouped).forEach(advList => {
                advList.sort((a, b) => {
                    // In-progress first
                    if (a.hasProgress && !b.hasProgress) return -1;
                    if (!a.hasProgress && b.hasProgress) return 1;
                    return 0;
                });
            });

            const playerLabel = currentPlayerName ? `${currentPlayerName}: ` : '';
            statsText.textContent = `${playerLabel}${completedCount.total}/${totalAdvancements} completed ‚Ä¢ ${incompleteAdvancements.length} remaining`;
            statsContainer.style.display = 'block';

            let html = '';
            
            // Sort tabs
            const tabOrder = ['minecraft', 'adventure', 'nether', 'the_end', 'husbandry'];
            const sortedTabs = Object.keys(grouped).sort((a, b) => {
                const aIndex = tabOrder.indexOf(a);
                const bIndex = tabOrder.indexOf(b);
                if (aIndex === -1 && bIndex === -1) return 0;
                if (aIndex === -1) return 1;
                if (bIndex === -1) return -1;
                return aIndex - bIndex;
            });
            
            sortedTabs.forEach(tab => {
                const advancements = grouped[tab];
                html += `<div class="advancement-category">`;
                html += `<div class="category-header">${formatTabName(tab)} (${advancements.length})</div>`;
                
                advancements.forEach(adv => {
                    const typeIcon = adv.type === 'challenge' ? '‚≠ê' : adv.type === 'goal' ? 'üéØ' : 'üìã';
                    const progressClass = adv.hasProgress ? 'has-progress' : '';
                    
                    let criteriaHtml = '';
                    
                    // Show progress info if this is a multi-criteria advancement
                    if (adv.totalCriteria > 0) {
                        const progressText = `${adv.completedCount}/${adv.totalCriteria} completed`;
                        
                        if (adv.missingCriteria.length > 0) {
                            criteriaHtml = `
                                <div class="missing-items">
                                    <div class="missing-items-title">‚ùå Still needed (${adv.missingCriteria.length}): <span style="color: #888; font-weight: normal;">${progressText}</span></div>
                                    ${adv.missingCriteria.map(c => 
                                        `<span class="missing-item clickable-criteria" data-advancement="${adv.key}" data-criteria="${c}">${formatCriteriaName(c)}</span>`
                                    ).join('')}
                                </div>
                            `;
                        } else if (adv.completedCount > 0) {
                            criteriaHtml = `
                                <div class="missing-items">
                                    <div class="missing-items-title" style="color: #4CAF50;">‚úÖ All criteria tracked as done! ${progressText}</div>
                                </div>
                            `;
                        }
                    }

                    html += `
                        <div class="advancement-item ${progressClass}" data-key="${adv.key}">
                            <div class="advancement-name" style="cursor: pointer;">‚òê ${typeIcon} ${adv.name}</div>
                            <div class="advancement-description">${adv.description}</div>
                            <div class="advancement-progress">${adv.requirement}</div>
                            ${criteriaHtml}
                        </div>
                    `;
                });
                
                html += '</div>';
            });
            
            listContainer.innerHTML = html;

            // Add click handlers to hide advancements
            document.querySelectorAll('.advancement-item').forEach(item => {
                const nameElement = item.querySelector('.advancement-name');
                nameElement.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const key = item.dataset.key;
                    hiddenAdvancements.add(key);
                    item.classList.add('hidden');
                    displayAdvancements();
                });
            });

            // Add click handlers for criteria items
            document.querySelectorAll('.clickable-criteria').forEach(item => {
                item.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const advKey = this.dataset.advancement;
                    const criteria = this.dataset.criteria;
                    
                    // Initialize set for this advancement if needed
                    if (!hiddenCriteriaItems[advKey]) {
                        hiddenCriteriaItems[advKey] = new Set();
                    }
                    
                    // Add to hidden set
                    hiddenCriteriaItems[advKey].add(criteria);
                    
                    // Animate and remove
                    this.style.transition = 'all 0.3s ease';
                    this.style.opacity = '0';
                    this.style.transform = 'scale(0.8)';
                    
                    setTimeout(() => {
                        displayAdvancements();
                    }, 200);
                });
            });
        }

        // Format criteria names nicely (convert snake_case to Title Case)
        function formatCriteriaName(name) {
            return name.split('_')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');
        }

        function formatTabName(tab) {
            // Format tab name for display
            return tab.split('_')
                .map(word => word.charAt(0).toUpperCase() + word.slice(1))
                .join(' ');
        }

        // Initialize the app
        init();
    </script>
</body>
</html>